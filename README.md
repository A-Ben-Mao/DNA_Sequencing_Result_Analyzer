# DNA Sequencing Result Analyzer

本工具用于 **自动分析 DNA 测序结果**，支持 **AB1 (测序原始文件)** 和 **FASTA (序列比对文件)**。  
它可以帮助研究人员快速判断样本的基因型（**杂合子 / 野生纯合 / 突变纯合**），并输出结果与运行参数到 CSV 文件。  

---
构建小鼠或者斑马鱼品系后，需要对子代剪鼠尾或者剪鱼鳍后PCR进行DNA测序后确定基因型，挨个对比我觉得太花费时间，所以借助ai写了一个自动判定测序结果的代码，以快速的判定对应样本的基因型。
**小孩子不懂事，没事写着玩的.jpg**

---

## 功能特性
- **输入文件**  
  - `.dna` → 参考野生型 DNA 序列  
  - `.ab1` → Sanger 测序峰图文件  
  - `.fasta` → 测序序列文件  
- **参数可在界面中设置**  
- **自动判定样本基因型**：
  - AB1 文件 → 杂合 / 纯合  
  - FASTA 文件 → 野生型 / 突变型  
- **综合结果导出 CSV**（样本结果 + 参数记录）  

---

## 判定原理说明

### 1. AB1 文件 → 判断杂合/纯合
- **原理**：AB1 文件保存 Sanger 测序峰图，每个碱基都有 **Phred 质量值 (Q 值)**。  
- **思路**：
  - 纯合子：每个位点单峰 → Q 值稳定且较高  
  - 杂合子：同一位点叠峰 → Q 值下降  
- **实现**：
  1. 去掉开头低质量片段（测序前段常峰重叠）  
  2. 统计剩余片段低质量碱基比例  
  3. 若比例超阈值 → 杂合；否则 → 纯合  

### 2. FASTA 文件 → 判断野生型/突变型
- **原理**：与参考 DNA 比对，判断序列是否含突变  
- **思路**：
  - 匹配比例高 → 野生型 (WT)  
  - 匹配比例低 → 突变型 (Mutant)  
- **实现**：
  1. 去掉首尾低质量碱基  
  2. 局部比对参考序列  
  3. 根据匹配比例阈值判定 WT/Mutant  

### 3. 综合判定逻辑
- AB1 杂合 → 综合判定为 **杂合子**  
- AB1 纯合 → 根据 FASTA 判定：
  - FASTA WT → **野生纯合**  
  - FASTA Mutant → **突变纯合**  

---

## 参数说明及原理

| 参数 | 默认值 | 说明与原理 |
|------|--------|------------|
| 杂/纯合判断中 去掉前多少 bp | 30 | 去掉测序起始端低质量片段，减少误判 |
| 杂/纯合判断中 Phred 质量阈值 | 20 | Q=20 对应碱基识别正确率约 99%，低于此值认为质量差 |
| 杂/纯合判断中 低质量比例阈值 | 0.15 | 若低质量碱基占比 >15%，判为杂合 |
| 野生/突变判断中 匹配比例阈值 | 0.85 | 比对匹配率 ≥85% 认为 WT，否则判突变 |
| 野生/突变判断中 去掉首尾 bp 数 | 15 | 去掉测序末端低质量碱基，提升比对准确度 |

---

## 安装与运行

### 依赖
- Python 3.8+
- Biopython
- Tkinter（Python 自带）

### 安装依赖
```bash
pip install biopython
